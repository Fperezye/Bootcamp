<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="calculadora.css" media="screen">
    <title>Document</title>
</head>
<body>
    <h1>Calculadora</h1>
    <div id="bloque">
        <textarea></textarea>
        <br>
        <p class="largo">
            <input class="operation" type="button" value="C">
            <input class="operation" type="button" value="Retr">
        </p>
        <p>
            <input class="numb" type="button" value="7">
            <input class="numb" type="button" value="8">
            <input class="numb" type="button" value="9">
            <input class="operation" type="button" value="/">
        </p>
        <p>
            <input class="numb" type="button" value="4">
            <input class="numb" type="button" value="5">
            <input class="numb" type="button" value="6">
            <input class="operation" type="button" value="*">
        </p>
        <p>
            <input class="numb" type="button" value="1">
            <input class="numb" type="button" value="2">
            <input class="numb" type="button" value="3">
            <input class="operation" type="button" value="-">
        </p>
        <p>
            <input class="operation" type="button" value="+-">
            <input class="numb" type="button" value="0">
            <input class="operation" type="button" value=",">
            <input class="operation" type="button" value="+">
            <input class="operation" type="button" value="=">
        </p>
    </div>
    <script>
        areaText = document.querySelector('textarea');
        resultado = 0;
        operation=0;
        xi=true;
        coma = false;
        op=false;
        function igualar() {
            if(operation !== 0){
                resultado = areaText.innerHTML = eval(oculto + operation + resultado);
                oculto = 0;
                coma = false;
                operation = 0;
                xi = true;
            }
        }
        document.querySelectorAll('.numb').forEach(button => button.addEventListener('click', ev => {
            if (resultado==0 || xi) {
                resultado = button.value;
                areaText.innerHTML = button.value;
            }
         else {
                resultado += button.value;
                areaText.innerHTML += button.value;
            }
            xi=false;
            
        }));
        document.querySelectorAll('.operation').forEach(button => button.addEventListener('click', ev => {
            if(button.value == "+"){
                igualar();
                oculto = resultado;
                operation = "+";
                xi=true;
                coma = false;
            } else if(button.value == "-"){
                igualar();
                oculto = resultado;
                operation = "-";
                xi=true;
                coma = false;
            } else if(button.value == "*"){
                igualar();
                oculto = resultado;
                operation = "*";
                xi=true;
                coma = false;
            }else if(button.value == "/"){
                igualar();
                oculto = resultado;
                operation = "/";
                xi=true;
                coma = false;
            } else if(button.value == "="){
                igualar();
            } else if(button.value == "C"){
                areaText.innerHTML = "";
                resultado = 0;
                operation = 0;
                oculto = 0;
                xi= true;
                coma = false;
            } else if(button.value == ","){
                if(!coma){
                    areaText.innerHTML += ".";
                    resultado += ".";
                    coma = true;
                }
            } else if(button.value == "+-"){
                resultado = String(-parseFloat(areaText.innerHTML));
                areaText.innerHTML = String(-parseFloat(areaText.innerHTML));
            } else if(button.value == "Retr"){
                br=resultado.substr(resultado.length-1,resultado.length);
                resultado=resultado.substr(0,resultado.length-1);
                if (resultado=="") {resultado="0";}
                if (br==".") {coma=false;}
                areaText.innerHTML=resultado;
            }

        }));
    </script>
</body>
</html>